/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function t(t,e,n,i){var s,r=arguments.length,o=r<3?e:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}console.groupCollapsed("%c⚠️ NINA DWD CARD%cv0.1.0","color: orange; font-weight: bold; background: black; padding: 2px 4px; border-radius: 2px 0 0 2px;","color: white; font-weight: bold; background: dimgray; padding: 2px 4px; border-radius: 0 2px 2px 0;"),console.info("A Home Assistant Lovelace card for NINA and DWD warnings."),console.info("Github:  https://github.com/timmaurice/lovelace-nina-dwd-card.git"),console.info("Sponsor: https://buymeacoffee.com/timmaurice"),console.groupEnd();const e=globalThis,n=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,i=Symbol(),s=new WeakMap;let r=class{constructor(t,e,n){if(this._$cssResult$=!0,n!==i)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(n&&void 0===t){const n=void 0!==e&&1===e.length;n&&(t=s.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&s.set(e,t))}return t}toString(){return this.cssText}};const o=t=>new r("string"==typeof t?t:t+"",void 0,i),a=(t,...e)=>{const n=1===t.length?t[0]:e.reduce((e,n,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+t[i+1],t[0]);return new r(n,t,i)},d=n?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return o(e)})(t):t,{is:c,defineProperty:h,getOwnPropertyDescriptor:l,getOwnPropertyNames:p,getOwnPropertySymbols:u,getPrototypeOf:_}=Object,g=globalThis,f=g.trustedTypes,m=f?f.emptyScript:"",$=g.reactiveElementPolyfillSupport,v=(t,e)=>t,w={toAttribute(t,e){switch(e){case Boolean:t=t?m:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},y=(t,e)=>!c(t,e),b={attribute:!0,type:String,converter:w,reflect:!1,useDefault:!1,hasChanged:y};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */Symbol.metadata??=Symbol("metadata"),g.litPropertyMetadata??=new WeakMap;let A=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=b){if(e.state&&(e.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((e=Object.create(e)).wrapped=!0),this.elementProperties.set(t,e),!e.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(t,n,e);void 0!==i&&h(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){const{get:i,set:s}=l(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get:i,set(e){const r=i?.call(this);s?.call(this,e),this.requestUpdate(t,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(v("elementProperties")))return;const t=_(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(v("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(v("properties"))){const t=this.properties,e=[...p(t),...u(t)];for(const n of e)this.createProperty(n,t[n])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,n]of e)this.elementProperties.set(t,n)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const n=this._$Eu(t,e);void 0!==n&&this._$Eh.set(n,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const t of n)e.unshift(d(t))}else void 0!==t&&e.push(d(t));return e}static _$Eu(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const n of e.keys())this.hasOwnProperty(n)&&(t.set(n,this[n]),delete this[n]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((t,i)=>{if(n)t.adoptedStyleSheets=i.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const n of i){const i=document.createElement("style"),s=e.litNonce;void 0!==s&&i.setAttribute("nonce",s),i.textContent=n.cssText,t.appendChild(i)}})(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$ET(t,e){const n=this.constructor.elementProperties.get(t),i=this.constructor._$Eu(t,n);if(void 0!==i&&!0===n.reflect){const s=(void 0!==n.converter?.toAttribute?n.converter:w).toAttribute(e,n.type);this._$Em=t,null==s?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(t,e){const n=this.constructor,i=n._$Eh.get(t);if(void 0!==i&&this._$Em!==i){const t=n.getPropertyOptions(i),s="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:w;this._$Em=i;const r=s.fromAttribute(e,t.type);this[i]=r??this._$Ej?.get(i)??r,this._$Em=null}}requestUpdate(t,e,n){if(void 0!==t){const i=this.constructor,s=this[t];if(n??=i.getPropertyOptions(t),!((n.hasChanged??y)(s,e)||n.useDefault&&n.reflect&&s===this._$Ej?.get(t)&&!this.hasAttribute(i._$Eu(t,n))))return;this.C(t,e,n)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,e,{useDefault:n,reflect:i,wrapped:s},r){n&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??e??this[t]),!0!==s||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||n||(e=void 0),this._$AL.set(t,e)),!0===i&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,n]of t){const{wrapped:t}=n,i=this[e];!0!==t||this._$AL.has(e)||void 0===i||this.C(e,void 0,n,i)}}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach(t=>t.hostUpdate?.()),this.update(e)):this._$EM()}catch(e){throw t=!1,this._$EM(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(t){}firstUpdated(t){}};A.elementStyles=[],A.shadowRootOptions={mode:"open"},A[v("elementProperties")]=new Map,A[v("finalized")]=new Map,$?.({ReactiveElement:A}),(g.reactiveElementVersions??=[]).push("2.1.1");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const x=globalThis,E=x.trustedTypes,S=E?E.createPolicy("lit-html",{createHTML:t=>t}):void 0,C="$lit$",D=`lit$${Math.random().toFixed(9).slice(2)}$`,P="?"+D,N=`<${P}>`,M=document,W=()=>M.createComment(""),T=t=>null===t||"object"!=typeof t&&"function"!=typeof t,O=Array.isArray,U="[ \t\n\f\r]",H=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,k=/-->/g,R=/>/g,I=RegExp(`>|${U}(?:([^\\s"'>=/]+)(${U}*=${U}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),j=/'/g,B=/"/g,z=/^(?:script|style|textarea|title)$/i,L=(t=>(e,...n)=>({_$litType$:t,strings:e,values:n}))(1),V=Symbol.for("lit-noChange"),F=Symbol.for("lit-nothing"),q=new WeakMap,Y=M.createTreeWalker(M,129);function K(t,e){if(!O(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==S?S.createHTML(e):e}const Z=(t,e)=>{const n=t.length-1,i=[];let s,r=2===e?"<svg>":3===e?"<math>":"",o=H;for(let e=0;e<n;e++){const n=t[e];let a,d,c=-1,h=0;for(;h<n.length&&(o.lastIndex=h,d=o.exec(n),null!==d);)h=o.lastIndex,o===H?"!--"===d[1]?o=k:void 0!==d[1]?o=R:void 0!==d[2]?(z.test(d[2])&&(s=RegExp("</"+d[2],"g")),o=I):void 0!==d[3]&&(o=I):o===I?">"===d[0]?(o=s??H,c=-1):void 0===d[1]?c=-2:(c=o.lastIndex-d[2].length,a=d[1],o=void 0===d[3]?I:'"'===d[3]?B:j):o===B||o===j?o=I:o===k||o===R?o=H:(o=I,s=void 0);const l=o===I&&t[e+1].startsWith("/>")?" ":"";r+=o===H?n+N:c>=0?(i.push(a),n.slice(0,c)+C+n.slice(c)+D+l):n+D+(-2===c?e:l)}return[K(t,r+(t[n]||"<?>")+(2===e?"</svg>":3===e?"</math>":"")),i]};class G{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let s=0,r=0;const o=t.length-1,a=this.parts,[d,c]=Z(t,e);if(this.el=G.createElement(d,n),Y.currentNode=this.el.content,2===e||3===e){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(i=Y.nextNode())&&a.length<o;){if(1===i.nodeType){if(i.hasAttributes())for(const t of i.getAttributeNames())if(t.endsWith(C)){const e=c[r++],n=i.getAttribute(t).split(D),o=/([.?@])?(.*)/.exec(e);a.push({type:1,index:s,name:o[2],strings:n,ctor:"."===o[1]?et:"?"===o[1]?nt:"@"===o[1]?it:tt}),i.removeAttribute(t)}else t.startsWith(D)&&(a.push({type:6,index:s}),i.removeAttribute(t));if(z.test(i.tagName)){const t=i.textContent.split(D),e=t.length-1;if(e>0){i.textContent=E?E.emptyScript:"";for(let n=0;n<e;n++)i.append(t[n],W()),Y.nextNode(),a.push({type:2,index:++s});i.append(t[e],W())}}}else if(8===i.nodeType)if(i.data===P)a.push({type:2,index:s});else{let t=-1;for(;-1!==(t=i.data.indexOf(D,t+1));)a.push({type:7,index:s}),t+=D.length-1}s++}}static createElement(t,e){const n=M.createElement("template");return n.innerHTML=t,n}}function J(t,e,n=t,i){if(e===V)return e;let s=void 0!==i?n._$Co?.[i]:n._$Cl;const r=T(e)?void 0:e._$litDirective$;return s?.constructor!==r&&(s?._$AO?.(!1),void 0===r?s=void 0:(s=new r(t),s._$AT(t,n,i)),void 0!==i?(n._$Co??=[])[i]=s:n._$Cl=s),void 0!==s&&(e=J(t,s._$AS(t,e.values),s,i)),e}class Q{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:n}=this._$AD,i=(t?.creationScope??M).importNode(e,!0);Y.currentNode=i;let s=Y.nextNode(),r=0,o=0,a=n[0];for(;void 0!==a;){if(r===a.index){let e;2===a.type?e=new X(s,s.nextSibling,this,t):1===a.type?e=new a.ctor(s,a.name,a.strings,this,t):6===a.type&&(e=new st(s,this,t)),this._$AV.push(e),a=n[++o]}r!==a?.index&&(s=Y.nextNode(),r++)}return Y.currentNode=M,i}p(t){let e=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class X{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,n,i){this.type=2,this._$AH=F,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t?.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=J(this,t,e),T(t)?t===F||null==t||""===t?(this._$AH!==F&&this._$AR(),this._$AH=F):t!==this._$AH&&t!==V&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):(t=>O(t)||"function"==typeof t?.[Symbol.iterator])(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==F&&T(this._$AH)?this._$AA.nextSibling.data=t:this.T(M.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:n}=t,i="number"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=G.createElement(K(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===i)this._$AH.p(e);else{const t=new Q(i,this),n=t.u(this.options);t.p(e),this.T(n),this._$AH=t}}_$AC(t){let e=q.get(t.strings);return void 0===e&&q.set(t.strings,e=new G(t)),e}k(t){O(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const s of t)i===e.length?e.push(n=new X(this.O(W()),this.O(W()),this,this.options)):n=e[i],n._$AI(s),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class tt{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,n,i,s){this.type=1,this._$AH=F,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=s,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=F}_$AI(t,e=this,n,i){const s=this.strings;let r=!1;if(void 0===s)t=J(this,t,e,0),r=!T(t)||t!==this._$AH&&t!==V,r&&(this._$AH=t);else{const i=t;let o,a;for(t=s[0],o=0;o<s.length-1;o++)a=J(this,i[n+o],e,o),a===V&&(a=this._$AH[o]),r||=!T(a)||a!==this._$AH[o],a===F?t=F:t!==F&&(t+=(a??"")+s[o+1]),this._$AH[o]=a}r&&!i&&this.j(t)}j(t){t===F?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class et extends tt{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===F?void 0:t}}class nt extends tt{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==F)}}class it extends tt{constructor(t,e,n,i,s){super(t,e,n,i,s),this.type=5}_$AI(t,e=this){if((t=J(this,t,e,0)??F)===V)return;const n=this._$AH,i=t===F&&n!==F||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,s=t!==F&&(n===F||i);i&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class st{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){J(this,t)}}const rt=x.litHtmlPolyfillSupport;rt?.(G,X),(x.litHtmlVersions??=[]).push("3.3.1");const ot=globalThis;
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class at extends A{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,n)=>{const i=n?.renderBefore??e;let s=i._$litPart$;if(void 0===s){const t=n?.renderBefore??null;i._$litPart$=s=new X(e.insertBefore(W(),t),t,void 0,n??{})}return s._$AI(t),s})(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return V}}at._$litElement$=!0,at.finalized=!0,ot.litElementHydrateSupport?.({LitElement:at});const dt=ot.litElementPolyfillSupport;dt?.({LitElement:at}),(ot.litElementVersions??=[]).push("4.2.1");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const ct=t=>(e,n)=>{void 0!==n?n.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)},ht={attribute:!0,type:String,converter:w,reflect:!1,hasChanged:y},lt=(t=ht,e,n)=>{const{kind:i,metadata:s}=n;let r=globalThis.litPropertyMetadata.get(s);if(void 0===r&&globalThis.litPropertyMetadata.set(s,r=new Map),"setter"===i&&((t=Object.create(t)).wrapped=!0),r.set(n.name,t),"accessor"===i){const{name:i}=n;return{set(n){const s=e.get.call(this);e.set.call(this,n),this.requestUpdate(i,s,t)},init(e){return void 0!==e&&this.C(i,void 0,t,e),e}}}if("setter"===i){const{name:i}=n;return function(n){const s=this[i];e.call(this,n),this.requestUpdate(i,s,t)}}throw Error("Unsupported decorator location: "+i)};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function pt(t){return(e,n)=>"object"==typeof n?lt(t,e,n):((t,e,n)=>{const i=e.hasOwnProperty(n);return e.constructor.createProperty(n,t),i?Object.getOwnPropertyDescriptor(e,n):void 0})(t,e,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function ut(t){return pt({...t,state:!0,attribute:!1})}const _t={de:{editor:{remove:"Entfernen",groups:{clear:"Leeren",core:"Grundeinstellungen"},title:"Titel (Optional)",nina_entity_prefix:"NINA Warngebiet",nina_entity_count:"Anzahl der NINA-Entitäten",dwd_device:"DWD Warnungs-Gerät",dwd_map_land:"DWD Warnkarte (Bundesland)",hide_no_warnings_message:"'Keine Warnungen'-Nachricht ausblenden",dwd_map_land_options:{baw:"Baden-Württemberg",bay:"Bayern",bbb:"Berlin, Brandenburg",hes:"Hessen",mvp:"Mecklenburg-Vorpommern",nib:"Niedersachsen, Bremen",nrw:"Nordrhein-Westfalen",rps:"Rheinland-Pfalz, Saarland",sac:"Sachsen",saa:"Sachsen-Anhalt",shh:"Schleswig-Holstein, Hamburg",thu:"Thüringen"}},card:{no_warnings:"Keine Warnungen",recommended_actions:"Handlungsempfehlungen",today:"Heute",tomorrow:"Morgen",time_unknown:"Zeit unbekannt",time_invalid:"Zeit ungültig"}},en:{editor:{remove:"Remove",groups:{clear:"Clear",core:"Core Configuration"},title:"Title (Optional)",nina_entity_prefix:"NINA Warning Area",nina_entity_count:"NINA Entity Count",dwd_device:"DWD Warnings Device",dwd_map_land:"DWD Warning Map (State)",hide_no_warnings_message:"Hide 'No Warnings' message",dwd_map_land_options:{baw:"Baden-Württemberg",bay:"Bavaria",bbb:"Berlin, Brandenburg",hes:"Hesse",mvp:"Mecklenburg-Western Pomerania",nib:"Lower Saxony, Bremen",nrw:"North Rhine-Westphalia",rps:"Rhineland-Palatinate, Saarland",sac:"Saxony",saa:"Saxony-Anhalt",shh:"Schleswig-Holstein, Hamburg",thu:"Thuringia"}},card:{no_warnings:"No Warnings",recommended_actions:"Recommended Actions",today:"Today",tomorrow:"Tomorrow",time_unknown:"Time unknown",time_invalid:"Time invalid"}}},gt=_t,ft=_t;function mt(t,e){let n=ft[t];for(const t of e){if("object"!=typeof n||null===n)return;n=n[t]}return"string"==typeof n?n:void 0}function $t(t,e,n={}){const i=t.language||"en",s=e.replace("component.nina-dwd-card.","").split("."),r=mt(i,s)??mt("en",s);if("string"==typeof r){let t=r;for(const e in n)t=t.replace(`{${e}}`,String(n[e]));return t}return e}const vt=(t,e,n,i)=>{const s=new CustomEvent(e,{bubbles:!0,cancelable:!1,composed:!0,...i,detail:n});t.dispatchEvent(s)};const wt=a`:host ::slotted(.card-content),.card-content{padding:16px}.no-warnings{font-weight:bold}.warning{padding:8px 0}.headline{font-size:1.1em;font-weight:bold;margin-bottom:4px}.time{color:var(--secondary-text-color);font-size:.9em;margin-bottom:8px}.description{margin-bottom:8px;white-space:pre-wrap}.sender{color:var(--secondary-text-color);font-size:.8em;font-style:italic}.footer{align-items:center;display:flex;justify-content:space-between;margin-top:8px}.info-button{--mdc-icon-button-size: 36px;color:var(--secondary-text-color)}.info-button:hover{color:var(--primary-text-color)}ha-expansion-panel{--expansion-panel-content-padding: 0 12px;--expansion-panel-header-padding: 8px 12px;margin-top:12px}.instruction{white-space:pre-wrap}.clearfix::after{content:"";display:table;clear:both}.warnings-container::after{content:"";display:table;clear:both}.map-image{border-radius:var(--ha-card-border-radius, 4px);float:right;margin-left:16px;margin-bottom:8px;max-width:40%;min-width:120px;shape-outside:margin-box}ha-icon{transform:translateY(-4px)}hr{border:none;border-top:1px solid var(--divider-color);margin:8px 0}`,yt={Minor:"#ffeb3b",Moderate:"#fb8c00",Severe:"#e53935",Extreme:"#880e4f",Unknown:"#999999"},bt={0:"#c5e566",1:"#ffeb3b",2:"#fb8c00",3:"#e53935",4:"#880e4f"};let At=class extends at{static async getConfigElement(){return await Promise.resolve().then(function(){return Ct}),document.createElement("nina-dwd-card-editor")}static getStubConfig(){return{title:"Warnings",type:"custom:nina-dwd-card",nina_entity_prefix:"",nina_entity_count:5,dwd_device:""}}setConfig(t){if(!t)throw new Error("Invalid configuration");if(!t.nina_entity_prefix&&!t.dwd_device)throw new Error("You need to define at least one NINA or DWD entity.");this._config={nina_entity_count:5,...t}}render(){if(!this._config||!this.hass)return L``;let t=this._getNinaWarnings(),e=[],n=[];if(this._config.dwd_device){const t=this._getDwdEntitiesFromDevice(this._config.dwd_device);t.current&&(e=this._getDwdWarnings(t.current)),t.advance&&(n=this._getDwdWarnings(t.advance))}(e.length>0||n.length>0)&&(t=t.filter(t=>"Deutscher Wetterdienst"!==t.sender));const i=new Map,s=(t,e)=>{if(!e)return`${t.toLowerCase().trim()}|${Math.random()}`;try{const n=new Date(e);return`${t.toLowerCase().trim()}|${n.toISOString().slice(0,13)}`}catch{return`${t.toLowerCase().trim()}|invalid_date`}};for(const r of[...t,...e,...n])if(r.headline&&r.start){const t=s(r.headline,r.start);i.has(t)||i.set(t,r)}let r;this._config.dwd_map_land&&(r=`https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_${this._config.dwd_map_land}.png`,r+=`?${(new Date).getTime()}`);const o=Array.from(i.values());return L`
      <ha-card .header=${this._config.title}>
        <div class="card-content">
          <div class="warnings-container">
            ${0===o.length&&this._config.hide_no_warnings_message?"":0===o.length?L`<div class="no-warnings" style="color: ${bt[0]}">No Warnings</div>`:o.map((t,e)=>L`
                      ${e>0?L`<hr />`:""}
                      <div class="warning">
                        ${"level"in t&&r?L`<img class="map-image" src=${r} alt="DWD Warning Map" />`:""}
                        <div
                          class="headline"
                          style="color: ${"severity"in t?yt[t.severity]:bt[t.level]||"#999999"}"
                        >
                          ${t.headline}
                        </div>
                        <div class="time">${function(t,e){try{const n="start"in t?t.start:"",i="expires"in t?t.expires:t.end;if(!n)return $t(e,"card.time_unknown");const s=new Date(n),r=new Date,o={hour:"numeric",minute:"numeric"},a=t=>{const n=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1),s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return s.getTime()===n.getTime()?$t(e,"card.today"):s.getTime()===i.getTime()?$t(e,"card.tomorrow"):new Intl.DateTimeFormat(e.locale.language,{weekday:"short"}).format(t)},d=new Intl.DateTimeFormat(e.locale.language,o).format(s),c=a(s);if(!i)return`${c}, ${d}`;const h=new Date(i),l=new Intl.DateTimeFormat(e.locale.language,o).format(h),p=a(h);return c===p?`${c}, ${d} - ${l}`:`${c}, ${d} - ${p}, ${l}`}catch(t){return console.error("Error formatting time:",t),$t(e,"card.time_invalid")}}(t,this.hass)}</div>
                        <div class="description">${t.description}</div>
                        ${"level"in t&&r?L`<div class="clearfix"></div>`:""}
                        ${"instruction"in t&&t.instruction?L` <ha-expansion-panel outlined>
                              <div slot="header">${$t(this.hass,"card.recommended_actions")}</div>
                              <div class="instruction">${t.instruction}</div>
                            </ha-expansion-panel>`:""}
                        <div class="footer">
                          <div class="sender">
                            ${"sender"in t&&t.sender?`Source: ${t.sender}`:""}
                          </div>
                          <ha-icon-button
                            class="info-button"
                            .label=${`More info for ${t.headline}`}
                            @click=${()=>this._handleMoreInfo(t.entity_id)}
                            ><ha-icon icon="mdi:information-outline"></ha-icon
                          ></ha-icon-button>
                        </div>
                      </div>
                    `)}
          </div>
        </div>
      </ha-card>
    `}_getNinaWarnings(){const t=[];if(!this._config.nina_entity_prefix)return t;for(let e=1;e<=(this._config.nina_entity_count??5);e++){const n=`${this._config.nina_entity_prefix}_${e}`,i=this.hass.states[n];i&&"on"===i.state&&t.push({headline:i.attributes.headline,description:i.attributes.description,sender:i.attributes.sender,entity_id:n,severity:i.attributes.severity,start:i.attributes.start,expires:i.attributes.expires,instruction:i.attributes.instruction||i.attributes.recommended_actions})}return t}_getDwdWarnings(t){const e=[];if(!t)return e;const n=this.hass.states[t];if(!n||"0"===n.state)return e;const i=parseInt(n.state,10)||0;for(let s=1;s<=i;s++)e.push({headline:n.attributes[`warning_${s}_headline`],description:n.attributes[`warning_${s}_description`],entity_id:t,level:n.attributes[`warning_${s}_level`],start:n.attributes[`warning_${s}_start`],end:n.attributes[`warning_${s}_end`],instruction:n.attributes[`warning_${s}_instruction`]});return e}_getDwdEntitiesFromDevice(t){const e={};if(!t)return e;for(const n in this.hass.entities){this.hass.entities[n].device_id===t&&(n.endsWith("_aktuelle_warnstufe")||n.endsWith("_current_warning_level")?e.current=n:(n.endsWith("_vorwarnstufe")||n.endsWith("_advance_warning_level"))&&(e.advance=n))}return e}_handleMoreInfo(t){vt(this,"hass-more-info",{entityId:t})}static{this.styles=a`
    ${o(wt)}
  `}};t([pt({attribute:!1})],At.prototype,"hass",void 0),t([ut()],At.prototype,"_config",void 0),At=t([ct("nina-dwd-card")],At),window.customCards=window.customCards||[],window.customCards.push({type:"nina-dwd-card",name:"NINA and DWD Warnings Card",preview:!0,description:"A card to display warnings from NINA and DWD."});const xt=a`.card-config{display:flex;flex-direction:column;gap:12px}.group{padding-bottom:16px}.group-header{font-weight:bold;margin-bottom:8px}.group>ha-textfield{width:100%}.group>ha-select{display:block;width:100%}.entity-row{align-items:center;display:flex;gap:8px}.entity-row ha-entity-picker{flex-grow:1}`,Et=[{name:"nina_entity_count",selector:{number:{min:1,max:20,step:1,mode:"box"}}},{name:"dwd_device",selector:{device:{integration:"dwd_weather_warnings"}}},{name:"dwd_map_land",selector:{select:{mode:"dropdown"}}},{name:"hide_no_warnings_message",selector:{boolean:{}}}];let St=class extends at{setConfig(t){this._config=t}_valueChanged(t){if(!this.hass||!this._config)return;const e={...this._config,...t.detail.value};e.dwd_device||delete e.dwd_map_land,vt(this,"config-changed",{config:e})}render(){if(!this.hass||!this._config)return L``;const t=[...new Set(Object.keys(this.hass.states).filter(t=>{const e=this.hass.states[t];return t.startsWith("binary_sensor.")&&e?.attributes.sender&&t.endsWith("_1")}).map(t=>{const e=t.replace(/_\d+$/,"");return{label:(this.hass.states[t]?.attributes.friendly_name||e).replace(/(?:\sWarning)?\s*\d*$/,"").trim(),value:e}}))],e=this.hass.language||"en",n=gt[e]?.editor.dwd_map_land_options||gt.en.editor.dwd_map_land_options;let i=[...Et];this._config.dwd_device||(i=i.filter(t=>"dwd_map_land"!==t.name));const s=i.map(t=>"dwd_map_land"===t.name?{...t,selector:{select:{mode:"dropdown",options:Object.keys(n).map(t=>({value:"none"===t?"":t,label:$t(this.hass,`component.nina-dwd-card.editor.dwd_map_land_options.${t}`)}))}}}:t);return L`
      <ha-card>
        <div class="card-content card-config">
          <div class="group">
            <div class="group-header">${$t(this.hass,"component.nina-dwd-card.editor.groups.core")}</div>
            <ha-textfield
              .label=${$t(this.hass,"component.nina-dwd-card.editor.title")}
              .value=${this._config.title||""}
              .configValue=${"title"}
              @input=${this._titleChanged}
            ></ha-textfield>
            <ha-select
              .label=${$t(this.hass,"component.nina-dwd-card.editor.nina_entity_prefix")}
              .value=${this._config.nina_entity_prefix||""}
              .configValue=${"nina_entity_prefix"}
              @selected=${this._ninaPrefixChanged}
              @closed=${t=>t.stopPropagation()}
              fixedMenuPosition
              naturalMenuWidth
            >
              ${t.map(t=>L`<mwc-list-item .value=${t.value}>${t.label}</mwc-list-item>`)}
            </ha-select>
            <ha-form
              .schema=${s}
              .hass=${this.hass}
              .data=${this._config}
              .computeLabel=${t=>$t(this.hass,`component.nina-dwd-card.editor.${t.name}`)}
              @value-changed=${this._valueChanged}
            ></ha-form>
          </div>
        </div>
      </ha-card>
    `}_titleChanged(t){const e=t.target;this._config={...this._config,title:e.value},vt(this,"config-changed",{config:this._config})}_ninaPrefixChanged(t){t.stopPropagation();const e=t.target;this._valueChanged({detail:{value:{nina_entity_prefix:e.value}}})}static{this.styles=a`
    ${o(xt)}
  `}};t([pt({attribute:!1})],St.prototype,"hass",void 0),t([ut()],St.prototype,"_config",void 0),St=t([ct("nina-dwd-card-editor")],St);var Ct=Object.freeze({__proto__:null,get NinaDwdCardEditor(){return St}});export{At as NinaDwdCard};
